"use strict";(()=>{function c(e,n,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?e!==n||!s:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:n.get(e)}function h(e,n,t,s,i){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?e!==n||!i:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?i.call(e,t):i?i.value=t:n.set(e,t),t}var d,u,_,I,S,D="__TAURI_TO_IPC_KEY__";function v(e,n=!1){return window.__TAURI_INTERNALS__.transformCallback(e,n)}var b=class{constructor(n){d.set(this,void 0),u.set(this,0),_.set(this,[]),I.set(this,void 0),h(this,d,n||(()=>{}),"f"),this.id=v(t=>{let s=t.index;if("end"in t){s==c(this,u,"f")?this.cleanupCallback():h(this,I,s,"f");return}let i=t.message;if(s==c(this,u,"f")){for(c(this,d,"f").call(this,i),h(this,u,c(this,u,"f")+1,"f");c(this,u,"f")in c(this,_,"f");){let r=c(this,_,"f")[c(this,u,"f")];c(this,d,"f").call(this,r),delete c(this,_,"f")[c(this,u,"f")],h(this,u,c(this,u,"f")+1,"f")}c(this,u,"f")===c(this,I,"f")&&this.cleanupCallback()}else c(this,_,"f")[s]=i})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(n){h(this,d,n,"f")}get onmessage(){return c(this,d,"f")}[(d=new WeakMap,u=new WeakMap,_=new WeakMap,I=new WeakMap,D)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[D]()}};async function l(e,n={},t){return window.__TAURI_INTERNALS__.invoke(e,n,t)}S=new WeakMap;var M;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(M||(M={}));async function R(e,n){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(e,n),await l("plugin:event|unlisten",{event:e,eventId:n})}async function T(e,n,t){var s;let i=typeof t?.target=="string"?{kind:"AnyLabel",label:t.target}:(s=t?.target)!==null&&s!==void 0?s:{kind:"Any"};return l("plugin:event|listen",{event:e,target:i,handler:v(n)}).then(r=>async()=>R(e,r))}async function P(e,n,t){return T(e,s=>{R(e,s.id),n(s)},t)}async function N(e,n){await l("plugin:event|emit",{event:e,payload:n})}var g={async openInput(e){return await l("plugin:midi|open_input",{id:e})},async closeInput(e){await l("plugin:midi|close_input",{id:e})},async openOutput(e){return await l("plugin:midi|open_output",{id:e})},async closeOutput(e){await l("plugin:midi|close_output",{id:e})},async outputSend(e,n){return await l("plugin:midi|output_send",{id:e,msg:n})}},A=x({midiMessage:"plugin:midi:midi-message",stateChange:"plugin:midi:state-change"});function x(e){return new Proxy({},{get:(n,t)=>{let s=e[t];return new Proxy((()=>{}),{apply:(i,r,[o])=>({listen:a=>o.listen(s,a),once:a=>o.once(s,a),emit:a=>o.emit(s,a)}),get:(i,r)=>{switch(r){case"listen":return o=>T(s,o);case"once":return o=>P(s,o);case"emit":return o=>N(s,o)}}})}})}var O,V=new Promise((e,n)=>{O=()=>e(void 0),setTimeout(()=>n(new Error("Failed to initialise WebMIDI")),1e4)}),C=[],L=[],W=new Set;A.stateChange.listen(e=>{let{inputs:n,outputs:t}=e.payload;C=n,L=t,O();for(let s of W)s.__tauri_statechange(n,t)});var p=class extends Event{constructor(n,t){super(n,t),this.port=t?.port||null}};globalThis.MIDIConnectionEvent=p;var f=class extends EventTarget{constructor(){super();this.sysexEnabled=!0;this.inputs=new Map;this.outputs=new Map;this.onstatechange=null;this.__tauri_statechange(C,L),W.add(this),this.addEventListener("statechange",t=>{if(this.onstatechange)return this.onstatechange(t)})}addEventListener(t,s,i){super.addEventListener(t,s,i)}removeEventListener(t,s,i){super.removeEventListener(t,s,i)}__tauri_statechange(t,s){let i=[];for(let[r,o]of this.inputs)t.find(([a,k])=>a===r)||(this.inputs.delete(r),o.state="disconnected",i.push(new p("disconnected",{port:o})));for(let[r,o]of this.outputs)s.find(([a,k])=>a===r)||(this.outputs.delete(r),o.state="disconnected",i.push(new p("disconnected",{port:o})));for(let[r,o]of t){if(this.inputs.has(r))continue;let a=new y(r,o);a.state="connected",this.inputs.set(r,a),i.push(new p("connected",{port:a}))}for(let[r,o]of s){if(this.outputs.has(r))continue;let a=new w(r,o);a.state="connected",this.outputs.set(r,a),i.push(new p("connected",{port:a}))}setTimeout(()=>i.forEach(r=>this.dispatchEvent(r)),0)}};globalThis.MIDIAccess=f;var m=class extends EventTarget{constructor(t,s,i){super();this.identifier=t;this.name=s;this.type=i;this.connection="closed";this.manufacturer=null;this.onstatechange=null;this.state="disconnected";this.version=null;this.id=t,this.name=s}async open(){return this.connection==="open"||this.connection==="pending"?this:this.state==="disconnected"?(this.connection="pending",this.dispatchEvent(new Event("statechange")),this):(this.type==="input"?await g.openInput(this.id):await g.openOutput(this.id),this.connection="open",this.dispatchEvent(new Event("statechange")),this)}async close(){return this.connection==="closed"?this:(this.type==="input"?await g.closeInput(this.id):await g.closeOutput(this.id),this.connection="closed",this.dispatchEvent(new Event("statechange")),this)}};globalThis.MIDIPort=m;var E=class extends Event{constructor(n,t){super(n,t),this.data=t?.data??new Uint8Array(0)}};globalThis.MIDIMessageEvent=E;var y=class extends m{constructor(t,s){super(t,s,"input");this._onmidimessage=null;this.addEventListener("midimessage",i=>{if(this.onmidimessage)return this.onmidimessage(i)})}open(){return this.stopListening||(this.stopListening=A.midiMessage.listen(t=>{let[s,i]=t.payload;s===this.id&&this.dispatchEvent(new E("midimessage",{data:new Uint8Array(i)}))})),super.open()}close(){return this.stopListening&&(this.stopListening?.then(t=>t()),this.stopListening=void 0),super.close()}get onmidimessage(){return this._onmidimessage}set onmidimessage(t){this._onmidimessage=t,this.connection!=="open"&&this.open()}};globalThis.MIDIInput=y;var w=class extends m{constructor(n,t){super(n,t,"output")}send(n){if(this.state==="disconnected")throw new Error("MIDIOutput is disconnected");(this.state==="connected"&&this.connection==="closed"?this.open():Promise.resolve()).then(()=>g.outputSend(this.id,n))}};globalThis.MIDIOutput=w;navigator.requestMIDIAccess=()=>V.then(()=>new f);})();
