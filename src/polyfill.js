"use strict";(()=>{var T,D,M,R;function y(e,s=!1){return window.__TAURI_INTERNALS__.transformCallback(e,s)}T=new WeakMap,D=new WeakMap,M=new WeakMap;async function a(e,s={},t){return window.__TAURI_INTERNALS__.invoke(e,s,t)}R=new WeakMap;var f;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(f||(f={}));async function v(e,s){await a("plugin:event|unlisten",{event:e,eventId:s})}async function h(e,s,t){var n;let o=typeof t?.target=="string"?{kind:"AnyLabel",label:t.target}:(n=t?.target)!==null&&n!==void 0?n:{kind:"Any"};return a("plugin:event|listen",{event:e,target:o,handler:y(s)}).then(u=>async()=>v(e,u))}async function w(e,s,t){return h(e,n=>{v(e,n.id),s(n)},t)}async function A(e,s){await a("plugin:event|emit",{event:e,payload:s})}var p={async openInput(e){await a("plugin:midi|open_input",{name:e})},async closeInput(e){await a("plugin:midi|close_input",{name:e})},async openOutput(e){await a("plugin:midi|open_output",{name:e})},async closeOutput(e){await a("plugin:midi|close_output",{name:e})},async outputSend(e,s){await a("plugin:midi|output_send",{name:e,msg:s})}},_=P({midiMessage:"plugin:midi:midi-message",stateChange:"plugin:midi:state-change"});function P(e){return new Proxy({},{get:(s,t)=>{let n=e[t];return new Proxy(()=>{},{apply:(o,u,[r])=>({listen:i=>r.listen(n,i),once:i=>r.once(n,i),emit:i=>r.emit(n,i)}),get:(o,u)=>{switch(u){case"listen":return r=>h(n,r);case"once":return r=>w(n,r);case"emit":return r=>A(n,r)}}})}})}var m=class extends EventTarget{constructor(){super();this.sysexEnabled=!0;this.inputs=new Map;this.outputs=new Map;this.onstatechange=null;let t;this.ready=new Promise((n,o)=>{t=n,setTimeout(()=>o(new Error("Failed to initialise WebMIDI")),1e4)}),_.stateChange.listen(n=>{let{inputs:o,outputs:u}=n.payload,r=!1;for(let[i,c]of this.inputs)o.includes(i)||(this.inputs.delete(i),c.state="disconnected",r=!0);for(let i of o){if(this.inputs.has(i))continue;let c=new I(i);c.state="connected",this.inputs.set(i,c),r=!0}for(let[i,c]of this.outputs)u.includes(i)||(this.outputs.delete(i),c.state="disconnected",r=!0);for(let i of u){if(this.outputs.has(i))continue;let c=new E(i);c.state="connected",this.outputs.set(i,c),r=!0}r&&this.dispatchEvent(new Event("statechange")),t(void 0)})}addEventListener(t,n,o){super.addEventListener(t,n,o)}removeEventListener(t,n,o){super.removeEventListener(t,n,o)}},l=class extends EventTarget{constructor(t,n){super();this.name=t;this.type=n;this.connection="closed";this.manufacturer=null;this.onstatechange=null;this.state="disconnected";this.version=null;this.id=t}async open(){return this.connection==="open"||this.connection==="pending"?this:this.state==="disconnected"?(this.connection="pending",d.dispatchEvent(new Event("statechange")),this.dispatchEvent(new Event("statechange")),this):(this.type==="input"?await p.openInput(this.id):await p.openOutput(this.id),this.connection="open",d.dispatchEvent(new Event("statechange")),this.dispatchEvent(new Event("statechange")),this)}async close(){return this.connection==="closed"?this:(this.type==="input"?await p.closeInput(this.id):await p.closeOutput(this.id),this.connection="closed",d.dispatchEvent(new Event("statechange")),this.dispatchEvent(new Event("statechange")),this)}},g=class extends Event{constructor(s,t){super(s,t),this.data=t?.data}},I=class extends l{constructor(t){super(t,"input");this._onmidimessage=null;this.addEventListener("midimessage",n=>{this.onmidimessage&&this.onmidimessage(n)})}open(){return this.stopListening||(this.stopListening=_.midiMessage.listen(t=>{let[n,o]=t.payload;n===this.name&&this.dispatchEvent(new g("midimessage",{data:new Uint8Array(o)}))})),super.open()}close(){return this.stopListening?.then(t=>t()),super.close()}get onmidimessage(){return this._onmidimessage}set onmidimessage(t){this._onmidimessage=t,this.connection!=="open"&&this.open()}},E=class extends l{constructor(s){super(s,"output")}send(s){if(this.state==="disconnected")throw new Error("MIDIOutput is disconnected");(this.state==="connected"&&this.connection==="closed"?this.open():Promise.resolve()).then(()=>p.outputSend(this.name,s))}},d=new m;navigator.requestMIDIAccess=()=>d.ready.then(()=>d);})();
