"use strict";(()=>{var R,P,N,W;function E(e,n=!1){return window.__TAURI_INTERNALS__.transformCallback(e,n)}R=new WeakMap,P=new WeakMap,N=new WeakMap;async function c(e,n={},t){return window.__TAURI_INTERNALS__.invoke(e,n,t)}W=new WeakMap;var y;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(y||(y={}));async function f(e,n){await c("plugin:event|unlisten",{event:e,eventId:n})}async function I(e,n,t){var s;let o=typeof t?.target=="string"?{kind:"AnyLabel",label:t.target}:(s=t?.target)!==null&&s!==void 0?s:{kind:"Any"};return c("plugin:event|listen",{event:e,target:o,handler:E(n)}).then(i=>async()=>f(e,i))}async function v(e,n,t){return I(e,s=>{f(e,s.id),n(s)},t)}async function w(e,n){await c("plugin:event|emit",{event:e,payload:n})}var p={async openInput(e){return await c("plugin:midi|open_input",{id:e})},async closeInput(e){await c("plugin:midi|close_input",{id:e})},async openOutput(e){return await c("plugin:midi|open_output",{id:e})},async closeOutput(e){await c("plugin:midi|close_output",{id:e})},async outputSend(e,n){return await c("plugin:midi|output_send",{id:e,msg:n})}},m=C({midiMessage:"plugin:midi:midi-message",stateChange:"plugin:midi:state-change"});function C(e){return new Proxy({},{get:(n,t)=>{let s=e[t];return new Proxy(()=>{},{apply:(o,i,[r])=>({listen:a=>r.listen(s,a),once:a=>r.once(s,a),emit:a=>r.emit(s,a)}),get:(o,i)=>{switch(i){case"listen":return r=>I(s,r);case"once":return r=>v(s,r);case"emit":return r=>w(s,r)}}})}})}var T,k=new Promise((e,n)=>{T=()=>e(void 0),setTimeout(()=>n(new Error("Failed to initialise WebMIDI")),1e4)}),A=[],M=[],D=new Set;m.stateChange.listen(e=>{let{inputs:n,outputs:t}=e.payload;A=n,M=t,T();for(let s of D)s.__tauri_statechange(n,t)});var u=class extends Event{constructor(n,t){super("statechange",t),this.port=t?.port||null}};globalThis.MIDIConnectionEvent=u;var d=class extends EventTarget{constructor(){super();this.sysexEnabled=!0;this.inputs=new Map;this.outputs=new Map;this.onstatechange=null;this.__tauri_statechange(A,M),D.add(this),this.addEventListener("statechange",t=>{if(this.onstatechange)return this.onstatechange(t)})}addEventListener(t,s,o){super.addEventListener(t,s,o)}removeEventListener(t,s,o){super.removeEventListener(t,s,o)}__tauri_statechange(t,s){let o=[];for(let[i,r]of this.inputs)t.find(([a,b])=>a===i)||(this.inputs.delete(i),r.state="disconnected",o.push(new u("disconnected",{port:r})));for(let[i,r]of this.outputs)s.find(([a,b])=>a===i)||(this.outputs.delete(i),r.state="disconnected",o.push(new u("disconnected",{port:r})));for(let[i,r]of t){if(this.inputs.has(i))continue;let a=new _(i,r);a.state="connected",this.inputs.set(i,a),o.push(new u("connected",{port:a}))}for(let[i,r]of s){if(this.outputs.has(i))continue;let a=new g(i,r);a.state="connected",this.outputs.set(i,a),o.push(new u("connected",{port:a}))}setTimeout(()=>o.forEach(i=>this.dispatchEvent(i)),0)}};globalThis.MIDIAccess=d;var l=class extends EventTarget{constructor(t,s,o){super();this.identifier=t;this.name=s;this.type=o;this.connection="closed";this.manufacturer=null;this.onstatechange=null;this.state="disconnected";this.version=null;this.id=t,this.name=s}async open(){return this.connection==="open"||this.connection==="pending"?this:this.state==="disconnected"?(this.connection="pending",this.dispatchEvent(new Event("statechange")),this):(this.type==="input"?await p.openInput(this.id):await p.openOutput(this.id),this.connection="open",this.dispatchEvent(new Event("statechange")),this)}async close(){return this.connection==="closed"?this:(this.type==="input"?await p.closeInput(this.id):await p.closeOutput(this.id),this.connection="closed",this.dispatchEvent(new Event("statechange")),this)}};globalThis.MIDIPort=l;var h=class extends Event{constructor(n,t){super(n,t),this.data=t?.data}};globalThis.MIDIMessageEvent=h;var _=class extends l{constructor(t,s){super(t,s,"input");this._onmidimessage=null;this.addEventListener("midimessage",o=>{if(this.onmidimessage)return this.onmidimessage(o)})}open(){return this.stopListening||(this.stopListening=m.midiMessage.listen(t=>{let[s,o]=t.payload;s===this.id&&this.dispatchEvent(new h("midimessage",{data:new Uint8Array(o)}))})),super.open()}close(){return this.stopListening?.then(t=>t()),super.close()}get onmidimessage(){return this._onmidimessage}set onmidimessage(t){this._onmidimessage=t,this.connection!=="open"&&this.open()}};globalThis.MIDIInput=_;var g=class extends l{constructor(n,t){super(n,t,"output")}send(n){if(this.state==="disconnected")throw new Error("MIDIOutput is disconnected");(this.state==="connected"&&this.connection==="closed"?this.open():Promise.resolve()).then(()=>p.outputSend(this.id,n))}};globalThis.MIDIOutput=g;navigator.requestMIDIAccess=()=>k.then(()=>new d);})();
