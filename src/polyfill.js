"use strict";(()=>{function c(e,s,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof s=="function"?e!==s||!n:!s.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:s.get(e)}function h(e,s,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof s=="function"?e!==s||!i:!s.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,t):i?i.value=t:s.set(e,t),t}var p,u,_,I,k,b="__TAURI_TO_IPC_KEY__";function w(e,s=!1){return window.__TAURI_INTERNALS__.transformCallback(e,s)}var D=class{constructor(s){p.set(this,void 0),u.set(this,0),_.set(this,[]),I.set(this,void 0),h(this,p,s||(()=>{}),"f"),this.id=w(t=>{let n=t.index;if("end"in t){n==c(this,u,"f")?this.cleanupCallback():h(this,I,n,"f");return}let i=t.message;if(n==c(this,u,"f")){for(c(this,p,"f").call(this,i),h(this,u,c(this,u,"f")+1,"f");c(this,u,"f")in c(this,_,"f");){let r=c(this,_,"f")[c(this,u,"f")];c(this,p,"f").call(this,r),delete c(this,_,"f")[c(this,u,"f")],h(this,u,c(this,u,"f")+1,"f")}c(this,u,"f")===c(this,I,"f")&&this.cleanupCallback()}else c(this,_,"f")[n]=i})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(s){h(this,p,s,"f")}get onmessage(){return c(this,p,"f")}[(p=new WeakMap,u=new WeakMap,_=new WeakMap,I=new WeakMap,b)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[b]()}};async function l(e,s={},t){return window.__TAURI_INTERNALS__.invoke(e,s,t)}k=new WeakMap;var M;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(M||(M={}));async function R(e,s){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(e,s),await l("plugin:event|unlisten",{event:e,eventId:s})}async function T(e,s,t){var n;let i=typeof t?.target=="string"?{kind:"AnyLabel",label:t.target}:(n=t?.target)!==null&&n!==void 0?n:{kind:"Any"};return l("plugin:event|listen",{event:e,target:i,handler:w(s)}).then(r=>async()=>R(e,r))}async function P(e,s,t){return T(e,n=>{R(e,n.id),s(n)},t)}async function N(e,s){await l("plugin:event|emit",{event:e,payload:s})}var g={async openInput(e){return await l("plugin:midi|open_input",{id:e})},async closeInput(e){await l("plugin:midi|close_input",{id:e})},async openOutput(e){return await l("plugin:midi|open_output",{id:e})},async closeOutput(e){await l("plugin:midi|close_output",{id:e})},async outputSend(e,s,t){return await l("plugin:midi|output_send",{id:e,msg:s,timestamp:t})}},A=x({midiMessage:"plugin:midi:midi-message",stateChange:"plugin:midi:state-change"});function x(e){return new Proxy({},{get:(s,t)=>{let n=e[t];return new Proxy((()=>{}),{apply:(i,r,[o])=>({listen:a=>o.listen(n,a),once:a=>o.once(n,a),emit:a=>o.emit(n,a)}),get:(i,r)=>{switch(r){case"listen":return o=>T(n,o);case"once":return o=>P(n,o);case"emit":return o=>N(n,o)}}})}})}var O,V=new Promise((e,s)=>{O=()=>e(void 0),setTimeout(()=>s(new Error("Failed to initialise WebMIDI")),1e4)}),C=[],L=[],W=new Set;A.stateChange.listen(e=>{let{inputs:s,outputs:t}=e.payload;C=s,L=t,O();for(let n of W)n.__tauri_statechange(s,t)});var d=class extends Event{constructor(s,t){super(s,t),this.port=t?.port||null}};globalThis.MIDIConnectionEvent=d;var f=class extends EventTarget{constructor(){super();this.sysexEnabled=!0;this.inputs=new Map;this.outputs=new Map;this.onstatechange=null;this.__tauri_statechange(C,L),W.add(this),this.addEventListener("statechange",t=>{if(this.onstatechange)return this.onstatechange(t)})}addEventListener(t,n,i){super.addEventListener(t,n,i)}removeEventListener(t,n,i){super.removeEventListener(t,n,i)}__tauri_statechange(t,n){let i=[];for(let[r,o]of this.inputs)t.find(([a,S])=>a===r)||(this.inputs.delete(r),o.state="disconnected",i.push(new d("disconnected",{port:o})));for(let[r,o]of this.outputs)n.find(([a,S])=>a===r)||(this.outputs.delete(r),o.state="disconnected",i.push(new d("disconnected",{port:o})));for(let[r,o]of t){if(this.inputs.has(r))continue;let a=new y(r,o);a.state="connected",this.inputs.set(r,a),i.push(new d("connected",{port:a}))}for(let[r,o]of n){if(this.outputs.has(r))continue;let a=new v(r,o);a.state="connected",this.outputs.set(r,a),i.push(new d("connected",{port:a}))}setTimeout(()=>i.forEach(r=>this.dispatchEvent(r)),0)}};globalThis.MIDIAccess=f;var m=class extends EventTarget{constructor(t,n,i){super();this.identifier=t;this.name=n;this.type=i;this.connection="closed";this.manufacturer=null;this.onstatechange=null;this.state="disconnected";this.version=null;this.id=t,this.name=n}async open(){return this.connection==="open"||this.connection==="pending"?this:this.state==="disconnected"?(this.connection="pending",this.dispatchEvent(new Event("statechange")),this):(this.type==="input"?await g.openInput(this.id):await g.openOutput(this.id),this.connection="open",this.dispatchEvent(new Event("statechange")),this)}async close(){return this.connection==="closed"?this:(this.type==="input"?await g.closeInput(this.id):await g.closeOutput(this.id),this.connection="closed",this.dispatchEvent(new Event("statechange")),this)}};globalThis.MIDIPort=m;var E=class extends Event{constructor(s,t){super(s,t),this.data=t?.data??new Uint8Array(new ArrayBuffer(0))}};globalThis.MIDIMessageEvent=E;var y=class extends m{constructor(t,n){super(t,n,"input");this._onmidimessage=null;this.addEventListener("midimessage",i=>{if(this.onmidimessage)return this.onmidimessage(i)})}open(){return this.stopListening||(this.stopListening=A.midiMessage.listen(t=>{let[n,i,r]=t.payload;if(n!==this.id)return;let o=parseInt(i),a=new E("midimessage",{data:new Uint8Array(r)});Object.defineProperty(a,"timeStamp",{value:o}),Object.defineProperty(a,"receivedTime",{value:o}),this.dispatchEvent(a)})),super.open()}close(){return this.stopListening&&(this.stopListening?.then(t=>t()),this.stopListening=void 0),super.close()}get onmidimessage(){return this._onmidimessage}set onmidimessage(t){this._onmidimessage=t,this.connection!=="open"&&this.open()}};globalThis.MIDIInput=y;var v=class extends m{constructor(s,t){super(s,t,"output")}send(s,t){if(this.state==="disconnected")throw new Error("MIDIOutput is disconnected");let n=this.state==="connected"&&this.connection==="closed"?this.open():Promise.resolve(),i=t?Math.trunc(performance.timeOrigin+t):null;n.then(()=>g.outputSend(this.id,s,i?i.toString():null))}};globalThis.MIDIOutput=v;navigator.requestMIDIAccess=()=>V.then(()=>new f);})();
